#===============================================================================
# InfluxDB Configuration with System Monitoring - Updated
# File: packages/influxdb.yaml
# Updated: 2025-08-22
# Added: Missing entities and new combined sensors
#===============================================================================

influxdb:  
  host: 192.168.1.30
  port: 8086
  database: home_assistant
  username: !secret influxdb_username
  password: !secret influxdb_password
  max_retries: 3
  default_measurement: state
  
  include:
    domains:
      - sensor
      - binary_sensor
    
    entity_globs:
      # Sunsynk/Deye inverters (existing)
      - "sensor.deyeinvertermaster_*"
      - "sensor.deyeinverterslave_*"
      
      # Prepaid meter (existing)
      - "sensor.prepaid_*"
      - "input_number.prepaid_*"
      
      # Energy monitoring (existing)
      - "sensor.*energy*"
      - "sensor.*power*"
      - "sensor.*battery*"
      
      # Speed test entities (existing)
      - "sensor.cloudflare_speed_test_*"
      - "sensor.speedtest_*"
      - "binary_sensor.speedtest_*"
      
      # System monitoring (existing)
      - "sensor.processor_*"
      - "sensor.memory_*"
      - "sensor.disk_*"
      - "sensor.swap_*"
      - "sensor.system_*"
      - "sensor.load_*"
      - "sensor.throughput_*"
      - "sensor.packets_*"
      - "sensor.ipv4_*"
      - "sensor.last_boot"
      - "binary_sensor.system_*"
      - "sensor.cpu_usage_*"
      - "sensor.memory_usage_*"
      
      # Battery Management (enhanced)
      - "sensor.battery_*"
      - "binary_sensor.battery_*"
      - "counter.battery_*"
      - "input_number.battery_*"
      
      # New combined sensors
      - "sensor.combined_*"
      - "sensor.total_grid_*"
      - "sensor.energy_independence_*"
      - "sensor.daily_*"
      - "sensor.monthly_*"
      
      # Helper entities monitoring
      - "sensor.missing_*"
      - "sensor.helper_entities_*"
      - "binary_sensor.all_critical_*"
    
    entities:
      # Specific battery sensors (from discovery)
      - sensor.temperature_humidity_sensor_battery
      - sensor.temperature_humidity_sensor_battery_2
      - sensor.motion_sensor_battery
      - sensor.snzb_05p_battery
      
      # Integration sensors (moved from main config)
      - sensor.deyeinvertermaster_summary_total_battery_charge_grid
      - sensor.deyeinverterslave_summary_total_battery_charge_grid
      - sensor.deyeinvertermaster_summary_total_pv_generation
      - sensor.deyeinverterslave_summary_total_pv_generation
      - sensor.deyeinvertermaster_summary_total_grid_export
      - sensor.deyeinverterslave_summary_total_grid_export
      
      # Combined template sensors
      - sensor.combined_solar_power
      - sensor.combined_battery_soc
      - sensor.total_grid_import
      - sensor.total_grid_export
      - sensor.daily_solar_generation_combined
      - sensor.energy_independence_percentage
      
      # Battery efficiency sensors
      - sensor.battery_efficiency_master
      - sensor.battery_efficiency_slave
      
      # Utility meter entities
      - sensor.deyeinvertermaster_summary_day_battery_charge_grid
      - sensor.deyeinverterslave_summary_day_battery_charge_grid
      - sensor.deyeinvertermaster_summary_day_pv_generation
      - sensor.deyeinverterslave_summary_day_pv_generation
      - sensor.deyeinvertermaster_summary_day_grid_export
      - sensor.deyeinverterslave_summary_day_grid_export